{% extends "base.html" %}

{% block title %}Message Board for CITS.... - TuitionTalk{% endblock %}

{% block content %}

<div id="message-board">
    <h2><span id="unitCode">{{ class_id }}</span> Message Thread</h2>
    <ul id="messages">
        <!-- Loop through each message and create a list item -->
        {% for message in messages %}
            {% if message.parent_id == None %}
            
                <li data-message-id="{{ message.id }}">
                    {{ message.user.username }}: {{ message.content }}
                    <button class="reply-btn" data-message-id="{{ message.id }}">Reply</button>
                    <div class="replies">
                        <ul>
                        {% for reply in messages %}

                            {% if reply.parent_id == message.id %}
                                <li>
                                    {{ reply.user.username }}: {{ reply.content }}
                                </li>
                            {% endif %}
                        {% endfor %}
                        </ul>
                        
                    </div>
                </li>
            {% endif %}

        {% endfor %}
    </ul>
</div>

<form id="message-board-form">
    <div class="form-group">
        <label for="message-label-input">Label:</label>
        <input type="text" id="message-label-input" name="message_label" placeholder="Enter your label here..." required>
    </div>
    <div class="form-group">
        <label for="message-board-input">Message:</label>
        <input type="text" id="message-board-input" placeholder="Enter your message here...">
    </div>
    <input type="hidden" id="message-board-parent-id"> <!-- Hidden field for storing parent ID -->
    <button type="submit">Submit Post</button>
</form>

{% endblock %}

{% block scripts %}
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
<script src="{{ url_for('static', filename='js/message_board.js') }}" defer></script>
{% endblock %}


